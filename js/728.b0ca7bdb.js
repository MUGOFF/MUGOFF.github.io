(self["webpackChunkmanual_project"]=self["webpackChunkmanual_project"]||[]).push([[728],{7421:function(t,a,e){"use strict";e.d(a,{Z:function(){return c}});var n=e(3396),o=e(7139);const i=["onDblclick"];function r(t,a,e,r,s,d){return(0,n.wg)(),(0,n.iD)("div",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.hashtags,((t,a)=>((0,n.wg)(),(0,n.iD)("span",{key:a,class:"hashtag",onDblclick:t=>d.removeHashtag(a)},"#"+(0,o.zw)(t),41,i)))),128))])}var s={props:{hashtags:{type:Array,default:()=>[]}},methods:{removeHashtag(t){this.$emit("remove-hashtag",t)}}},d=e(89);const l=(0,d.Z)(s,[["render",r]]);var c=l},4728:function(t,a,e){"use strict";e.r(a),e.d(a,{default:function(){return at}});var n=e(3396),o=e(9242),i=e(7139);const r={class:"container"},s={class:"d-flex justify-content-between"},d=["src"],l=(0,n._)("label",{for:"picker"},"날짜 범위 선택",-1),c=["id"],_={class:"table tableborderd table-sm"},u={colspan:"5"},m={rowspan:"2",class:"align-middle col-1"},h=["src"],g=["src"],p={class:"col-4",style:{border:"none"}},w=["onClick"],y={colspan:"2"},f={key:0},b={class:"modal fade",id:"category-select","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"CategorySelectLabel","aria-hidden":"true"},v={class:"modal-dialog"},k={class:"modal-content"},D=(0,n._)("div",{class:"modal-header"},[(0,n._)("h1",{class:"modal-title fs-5",id:"CategorySelectLabel"}," 거래 항목 설정 "),(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),C={class:"modal-body"},x={class:"nav nav-tabs"},V={class:"nav-item"},M={class:"nav-item"},T={class:"nav-item"},$={class:"list-group"},H=["value","onClick"],q={method:"dialog"},I={id:"dialog_body",class:"container text-start"},U={class:"input-group m-1"},j=(0,n._)("span",{class:"input-group-text"},"대항목",-1),z={class:"input-group m-1"},Z=(0,n._)("span",{class:"input-group-text"},"항목",-1),S=(0,n._)("button",{class:"m-2 btn btn-secondary",value:"close"},"취소",-1),L=(0,n._)("button",{class:"m-2 btn btn-info",value:"confirm"},"추가",-1);function A(t,a,A,B,E,Y){const O=(0,n.up)("router-link"),K=(0,n.up)("TransactionCalendar"),F=(0,n.up)("Hashtag");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",s,[(0,n._)("div",null,[(0,n.Wm)(O,{to:{name:"BudgetView",query:{year:E.date_now.year,month:E.date_now.month}}},{default:(0,n.w5)((()=>[(0,n._)("img",{src:e(1687),width:"90"},null,8,d)])),_:1},8,["to"])]),(0,n._)("div",null,[(0,n.wy)((0,n._)("input",{type:"checkbox",id:"picker","onUpdate:modelValue":a[0]||(a[0]=t=>E.picker=t)},null,512),[[o.e8,E.picker]]),l])]),(0,n.Wm)(K,{class:"mb-4",isExpanded:!0,isDatepicker:E.picker,date_now:E.date_now,deposit:Y.deposit_days,withdrawal:Y.withdrawal_days,onSend_range:Y.set_range,onMonth_year:Y.get_monthly_transactions},null,8,["isDatepicker","date_now","deposit","withdrawal","onSend_range","onMonth_year"]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Y.Transaction_exist_Date,((t,a)=>((0,n.wg)(),(0,n.iD)("div",{key:a},[(0,n._)("div",{class:"table-responsive collapse show",id:"date"+t+"transaction"},[(0,n._)("table",_,[(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",u,(0,i.zw)(this.date_now.month)+"월 "+(0,i.zw)(t)+"일",1)])]),(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Y.Date_filter_Transactions(t),((t,a)=>((0,n.wg)(),(0,n.iD)(n.HY,{key:a},[(0,n._)("tr",null,[(0,n._)("th",m,[(0,n._)("img",{src:e(3284)("./"+t.transaction_from_type+"CI.png"),width:"40"},null,8,h),t.transaction_from_card_str?((0,n.wg)(),(0,n.iD)("img",{key:0,src:e(3284)("./"+t.transaction_from_card_type+"CI.png"),width:"40"},null,8,g)):(0,n.kq)("",!0)]),(0,n._)("td",p,(0,i.zw)(t.transaction_to_name),1),(0,n._)("td",{class:"col-2",style:{border:"none",cursor:"pointer"},"data-bs-toggle":"modal","data-bs-target":"#category-select",onClick:a=>Y.main_category_select_modal(t)},(0,i.zw)(t.main_category),9,w),0!==t.deposit_amount?((0,n.wg)(),(0,n.iD)("td",{key:0,rowspan:"2",style:(0,i.j5)({color:this.main_in_flow(t.main_category,"이체")?"gray":"green"}),class:"align-middle col-2"}," + "+(0,i.zw)(t.deposit_amount.toLocaleString())+" ₩ ",5)):(0,n.kq)("",!0),0!==t.withdrawal_amount?((0,n.wg)(),(0,n.iD)("td",{key:1,rowspan:"2",style:(0,i.j5)({color:this.main_in_flow(t.main_category,"이체")?"gray":"red"}),class:"align-middle col-2"}," - "+(0,i.zw)(t.withdrawal_amount.toLocaleString())+" ₩ ",5)):(0,n.kq)("",!0)]),(0,n._)("tr",null,[(0,n._)("td",y,[0===t.sub_category.length?((0,n.wg)(),(0,n.iD)("span",f,"-")):((0,n.wg)(),(0,n.j4)(F,{key:1,hashtags:t.sub_category},null,8,["hashtags"]))])])],64)))),128))])])],8,c)])))),128)),(0,n._)("div",b,[(0,n._)("div",v,[(0,n._)("div",k,[D,(0,n._)("div",C,[(0,n._)("ul",x,[(0,n._)("li",V,[(0,n._)("label",{class:(0,i.C_)(["nav-link",{active:"수입"===E.add_form.flow}]),for:"income"},"수입",2),(0,n.wy)((0,n._)("input",{id:"income",class:"invisible",type:"radio",name:"flow","onUpdate:modelValue":a[1]||(a[1]=t=>E.add_form.flow=t),value:"수입",checked:""},null,512),[[o.G2,E.add_form.flow]])]),(0,n._)("li",M,[(0,n._)("label",{class:(0,i.C_)(["nav-link",{active:"소비"===E.add_form.flow}]),for:"consume"},"소비",2),(0,n.wy)((0,n._)("input",{id:"consume",class:"invisible",type:"radio",name:"flow","onUpdate:modelValue":a[2]||(a[2]=t=>E.add_form.flow=t),value:"소비"},null,512),[[o.G2,E.add_form.flow]])]),(0,n._)("li",T,[(0,n._)("label",{class:(0,i.C_)(["nav-link",{active:"이체"===E.add_form.flow}]),for:"transfer"},"이체",2),(0,n.wy)((0,n._)("input",{id:"transfer",class:"invisible",type:"radio",name:"flow","onUpdate:modelValue":a[3]||(a[3]=t=>E.add_form.flow=t),value:"이체"},null,512),[[o.G2,E.add_form.flow]])])]),(0,n._)("ul",$,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Y.category_each,((t,a)=>((0,n.wg)(),(0,n.iD)("button",{class:(0,i.C_)(["list-group-item",{active:E.selected_data.main_category===t}]),"aria-current":"true",key:a,value:t,onClick:a=>Y.main_category_select(t),"data-bs-dismiss":"modal"},(0,i.zw)(t),11,H)))),128)),(0,n._)("li",{class:"list-group-item",onClick:a[4]||(a[4]=t=>Y.main_category_modal())}," 항목 추가 ")])])])])]),(0,n._)("dialog",null,[(0,n._)("form",q,[(0,n._)("div",I,[(0,n._)("div",U,[j,(0,n.wy)((0,n._)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[5]||(a[5]=t=>E.add_form.flow=t),readonly:""},null,512),[[o.nr,E.add_form.flow]])]),(0,n._)("div",z,[Z,(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":a[6]||(a[6]=t=>E.add_form.main=t),class:"form-control"},null,512),[[o.nr,E.add_form.main]])])]),S,L])])])}var B=e(5939);const E={class:"container"},Y={class:"text-sm"};function O(t,a,e,o,r,s){const d=(0,n.up)("DatePicker"),l=(0,n.up)("Calendar");return(0,n.wg)(),(0,n.iD)("div",E,[e.isDatepicker?((0,n.wg)(),(0,n.j4)(d,{key:0,"initial-page":{month:e.date_now.month,year:e.date_now.year},expanded:e.isExpanded,attributes:r.attributes,"select-attribute":s.selectDragAttribute,"drag-attribute":s.selectDragAttribute,ref:"date",modelValue:r.date_pick,"onUpdate:modelValue":[a[0]||(a[0]=t=>r.date_pick=t),a[4]||(a[4]=t=>s.send_range(t))],modelModifiers:{range:!0},onTransitionStart:a[1]||(a[1]=t=>s.month_now()),"onUpdate:pages":a[2]||(a[2]=t=>s.ref_check()),onDrag:a[3]||(a[3]=t=>r.dragValue=t)},{"day-popover":(0,n.w5)((({format:t})=>[(0,n._)("div",Y,(0,i.zw)(t(r.dragValue?r.dragValue.start:r.date_pick.start,"MMM D"))+" - "+(0,i.zw)(t(r.dragValue?r.dragValue.end:r.date_pick.end,"MMM D")),1)])),_:1},8,["initial-page","expanded","attributes","select-attribute","drag-attribute","modelValue"])):((0,n.wg)(),(0,n.j4)(l,{key:1,"initial-page":{month:e.date_now.month,year:e.date_now.year},expanded:e.isExpanded,attributes:r.attributes,ref:"date",onTransitionStart:a[5]||(a[5]=t=>s.month_now()),"onUpdate:pages":a[6]||(a[6]=t=>s.ref_check())},null,8,["initial-page","expanded","attributes"]))])}var K=e(7108),F=e(4870);const G=e(4806);var N={name:"TransactionCalendar",components:{Calendar:K.f,DatePicker:K.Mt},data(){return{date:(0,F.iH)(null),date_pick:(0,F.iH)({start:new Date(this.date_now.year,this.date_now.month),end:new Date(this.date_now.year,this.date_now.month)}),dragValue:(0,F.iH)(null),attributes:[{key:"today",highlight:{color:"purple",fillMode:"solid",contentClass:"italic"},dates:new Date},{key:"withdrawal",dot:"red",dates:this.withdrawal},{key:"deposit",dot:"green",dates:this.deposit}]}},props:{date_now:{type:Object,default:()=>({month:(new Date).getMonth()+1,year:(new Date).getFullYear()})},deposit:{type:Array,default:()=>{}},withdrawal:{type:Array,default:()=>{}},isExpanded:{type:Boolean,default:()=>!1},isDatepicker:{type:Boolean,default:()=>!1}},computed:{selectDragAttribute(){return{popover:{visibility:"hover",isInteractive:!1}}}},methods:{send_range(t){this.$emit("send_range",t.start.getDate(),t.end.getDate())},ref_check(){G.find(this.attributes,{key:"deposit"}).dates=this.deposit,G.find(this.attributes,{key:"withdrawal"}).dates=this.withdrawal},month_now(){this.isDatepicker?this.$emit("month_year",this.$refs.date.calendarRef.pages[0].month,this.$refs.date.calendarRef.pages[0].year):this.$emit("month_year",this.$refs.date.pages[0].month,this.$refs.date.pages[0].year)}}},P=e(89);const R=(0,P.Z)(N,[["render",O]]);var W=R,J=e(7421);const Q=e(4806);var X={components:{TransactionCalendar:W,Hashtag:J.Z},data(){return{date_now:{year:this.$route.query.year?this.$route.query.year:(new Date).getFullYear(),month:this.$route.query.month?this.$route.query.month:(new Date).getMonth()+1},date_range:{start:0,end:31},add_form:{flow:"소비",main:""},picker:!1,selected_data:{},transaction_data:[],category_table:[]}},computed:{category_each(){const t=this.category_table.filter((t=>t.flow_category===this.add_form.flow)).map((t=>t.main_category));return t},Transaction_data_include_picker(){if(this.picker){const t=this.transaction_data.filter((t=>new Date(t.transaction_time).getDate()>=this.date_range.start&&new Date(t.transaction_time).getDate()<=this.date_range.end));return t}return this.transaction_data},Transaction_exist_Date(){const t=new Date(this.date_now.year,this.date_now.month,0).getDate(),a=this.Transaction_data_include_picker.map((t=>new Date(t.transaction_time).getDate()));return Q.range(1,t+1).filter((t=>a.includes(t)))},deposit_days(){const t=this.transaction_data.filter((t=>t.deposit_amount>0)),a=t.map((t=>new Date(t.transaction_time)));return Q.uniqBy(a,(t=>t.getDate()))},withdrawal_days(){const t=this.transaction_data.filter((t=>t.withdrawal_amount>0)),a=t.map((t=>new Date(t.transaction_time)));return Q.uniqBy(a,(t=>t.getDate()))}},created(){this.get_monthly_transactions(this.date_now.month,this.date_now.year),this.get_category()},methods:{async get_monthly_transactions(t,a){this.picker=!1,this.date_range.start=0,this.date_range.end=31,this.date_now.year=a,this.date_now.month=t,this.$store.commit("setIsLoading",!0),await B.Z.get("api/v1/account_transaction/"+a+"/"+t+"/").then((t=>{this.transaction_data=t.data})).catch((t=>{console.error(t)})),this.$store.commit("setIsLoading",!1)},get_category(){B.Z.get("api/v1/account_record/Category/").then((t=>{this.category_table=t.data})).catch((t=>{console.error(t)}))},Date_filter_Transactions(t){const a=this.transaction_data.filter((a=>Date.parse(a.transaction_time)>Date.parse(this.date_now.year+" "+this.date_now.month+" "+t+" 00:00:00")&&Date.parse(a.transaction_time)<Date.parse(this.date_now.year+" "+this.date_now.month+" "+(t+1)+" 00:00:00")));return a},main_in_flow(t,a){const e=this.category_table.filter((t=>t.flow_category===a)),n=e.map((t=>t.main_category));return n.includes(t)},main_category_select_modal(t){this.selected_data=t},main_category_select(t){this.selected_data.main_category=t,B.Z.put("api/v1/account_record/Transaction_All/"+this.selected_data.id+"/",{transaction_time:this.selected_data.transaction_time,transaction_from:this.selected_data.transaction_from,transaction_from_card:this.selected_data.transaction_from_card,transaction_to_name:this.selected_data.transaction_to_name.trim(),deposit_amount:this.selected_data.deposit_amount,withdrawal_amount:this.selected_data.withdrawal_amount,main_category:this.selected_data.main_category,sub_category:this.selected_data.sub_category,description:this.selected_data.description})},main_category_modal(){const t=document.querySelector("dialog");t.addEventListener("close",(()=>{const a=t.returnValue;if("confirm"===a){const t=this.add_form.main.trim();if(""===t)return alert("입력된 값이 없습니다"),!1;if(this.category_each.includes(t))return alert("이미 존재하는 항목입니다"),!1;B.Z.post("api/v1/account_record/Category/",{flow_category:this.add_form.flow,main_category:t}).then((()=>{this.add_form.main="",B.Z.get("api/v1/account_record/Category/").then((t=>{this.category_table=t.data}))}))}}),{once:!0}),t.showModal()},set_range(t,a){this.date_range.start=t,this.date_range.end=a}}};const tt=(0,P.Z)(X,[["render",A]]);var at=tt},3284:function(t,a,e){var n={"./BCCI.png":6176,"./기업은행CI.png":9266,"./대구은행CI.png":4321};function o(t){var a=i(t);return e(a)}function i(t){if(!e.o(n,t)){var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}return n[t]}o.keys=function(){return Object.keys(n)},o.resolve=i,t.exports=o,o.id=3284},6176:function(t,a,e){"use strict";t.exports=e.p+"img/BCCI.f1347649.png"},9266:function(t,a,e){"use strict";t.exports=e.p+"img/기업은행CI.2020dd80.png"},4321:function(t,a,e){"use strict";t.exports=e.p+"img/대구은행CI.95485cb8.png"},1687:function(t,a,e){"use strict";t.exports=e.p+"img/To_budget icon.8b05f7c5.png"}}]);
//# sourceMappingURL=728.b0ca7bdb.js.map